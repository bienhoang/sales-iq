# Brainstorm: Workspace Output Persistence

**Date:** 2026-02-24
**Status:** Agreed
**Problem:** 85% of skills (17/20) produce deliverables that vanish after conversation ends

---

## Problem Statement

Sales-IQ skills generate high-value deliverables (proposals, email sequences, ad copy, battle cards, reports) but most output only to the Claude conversation console. Users must manually copy/paste to preserve their work. For a professional sales/marketing toolkit, this is a critical UX gap.

### Current State

| Category | Count | Saves to File? |
|----------|-------|---------------|
| Skills with file-save instructions | 3 | siq-brand-strategy, siq-account-strategy, siq-research |
| Skills with console-only output | 17 | All others |
| MCP server tools | 6 | No persistence (in-memory JSON only) |
| Content calendar entries | - | Lost on MCP server restart |

---

## Agreed Solution

### Directory Structure (on-demand creation)

```
{project-slug}/
├─ CLAUDE.md                  (auto-generated)
├─ brand-context.md           (user-editable)
├─ brand-context.json         (structured)
├─ .sales-iq.json             (project config)
└─ workspace/                 ← NEW, created on-demand
   ├─ proposals/              ← siq-proposal-generator
   ├─ emails/                 ← siq-email-campaign, siq-follow-up
   ├─ outreach/               ← siq-outreach-sequence
   ├─ ad-copy/                ← siq-ad-copy
   ├─ content/                ← siq-seo-content, siq-content-repurpose
   ├─ social/                 ← siq-social-media-post, siq-social-media-calendar, siq-community-engagement
   ├─ intel/                  ← siq-competitor-intel, siq-lead-qualification
   ├─ reports/                ← siq-metrics-report, siq-pipeline-report
   ├─ strategy/               ← siq-strategy-consultant, siq-brand-strategy
   ├─ sales-prep/             ← siq-demo-prep, siq-objection-handling, siq-account-strategy
   └─ research/               ← siq-research, siq-brainstorm
```

### Key Decisions

| Decision | Choice | Rationale |
|----------|--------|-----------|
| Root directory name | `workspace/` | Active work area feel, implies iteration |
| Location | Inside project dir | Tied to brand/product, git-friendly, portable |
| Organization | By content type | Mirrors how users think about deliverables |
| Directory creation | On-demand | Keeps project clean initially |
| Save behavior | Auto-save + display | No friction, print file path after saving |
| File naming | `{descriptor}-{YYYY-MM-DD}.md` | Grouped by name, sortable by date |
| Path discovery | Walk up to find `.sales-iq.json` | Standard project detection pattern |
| Mechanism | Shared convention file | DRY, centralized rules, per-skill `output_dir` config |
| MCP persistence | Yes, to workspace/ | Data survives server restarts |

---

## Implementation Approach

### 1. Shared Output Convention File

Create `packages/skills/shared/output-convention.md`:
- Defines workspace path discovery (walk up for `.sales-iq.json`)
- Output rules: auto-save + display, create dirs on-demand
- File naming format: `{descriptor}-{YYYY-MM-DD}.md`
- Maps `output_dir` values to workspace subdirectories

### 2. Update All 20 SKILL.md Files

Add YAML-style output config to each skill:
```md
<!-- output_dir: proposals -->
```

Add "Output" section referencing shared convention:
```md
## Output
Follow output convention in `shared/output-convention.md`.
Save deliverables to `workspace/proposals/`.
```

### Skill → Output Directory Mapping

| Skill | output_dir |
|-------|-----------|
| siq-proposal-generator | proposals |
| siq-email-campaign | emails |
| siq-follow-up | emails |
| siq-outreach-sequence | outreach |
| siq-ad-copy | ad-copy |
| siq-seo-content | content |
| siq-content-repurpose | content |
| siq-social-media-post | social |
| siq-social-media-calendar | social |
| siq-community-engagement | social |
| siq-competitor-intel | intel |
| siq-lead-qualification | intel |
| siq-metrics-report | reports |
| siq-pipeline-report | reports |
| siq-strategy-consultant | strategy |
| siq-brand-strategy | strategy |
| siq-demo-prep | sales-prep |
| siq-objection-handling | sales-prep |
| siq-account-strategy | sales-prep |
| siq-research | research |
| siq-brainstorm | research |

### 3. Update Project CLAUDE.md Template

The CLAUDE.md generated by `sales-iq init` should include:
- Reference to the workspace convention
- Instruction for Claude to follow output-convention.md

### 4. MCP Server Persistence

- Content calendar: Write entries to `workspace/social/calendar-entries.json`
- Other MCP tools: Optionally log API responses to workspace

### 5. Skills Already Saving Files (Migration)

- **siq-brand-strategy**: Currently saves to its own `references/`. Keep for internal data; also save deliverables to `workspace/strategy/`
- **siq-account-strategy**: Currently saves to its own `references/`. Keep for per-account context; also save deliverables to `workspace/sales-prep/`
- **siq-research**: Already uses Report: path. Add workspace fallback.

---

## Implementation Scope

| Change | Files Affected | Effort |
|--------|---------------|--------|
| Create shared/output-convention.md | 1 new file | Small |
| Update 20 SKILL.md files | 20 files | Medium (repetitive) |
| Update CLI templates.ts | 1 file | Small |
| Update MCP content-calendar.ts | 1 file | Small |
| Update .sales-iq.json schema | 1 file | Small |
| Total | ~24 files | ~4-6h |

---

## Risks & Mitigations

| Risk | Mitigation |
|------|-----------|
| Skills are markdown — can't enforce file writes | Convention file makes instructions explicit; Claude follows markdown instructions well |
| Path discovery fails if user not in project dir | Clear error message: "No .sales-iq.json found. Run from project directory." |
| Workspace dir gets large over time | Not a concern for text files; user can git-manage or clean up |
| Naming collisions (same descriptor + date) | Append `-2`, `-3` suffix or include time component |

---

## Success Criteria

- [ ] Every skill auto-saves deliverables to `workspace/{type}/`
- [ ] File path printed after each save
- [ ] Directories created on-demand (no empty scaffolding)
- [ ] MCP content calendar persists across restarts
- [ ] `sales-iq init` project CLAUDE.md references output convention
- [ ] Existing skills (brand-strategy, account-strategy) continue working

---

## Next Steps

1. Create implementation plan with phased approach
2. Phase 1: shared/output-convention.md + update CLAUDE.md template
3. Phase 2: Update all 20 SKILL.md files with output_dir config
4. Phase 3: MCP server persistence
5. Phase 4: Test end-to-end with a sample project
